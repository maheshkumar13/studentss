<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">
<head>
</head>
<body>
	<form th:action="@{/scaits/assignTicketUpdate}" id="formid"
		method="post" enctype="multipart/form-data">
		<input type="hidden" id="ticket"
			th:value="${(ticketUpdateId!=null)?ticketUpdateId.id:''}"
			name="ticket">
		<div class="row">
			<div class="col-md-6 col-xs-6">
				<div class="form-group ">
					<select name="campus" id="campus" class="form-control "
						disabled="disabled">
						<option
							th:each="campus,campusStatus:${@currentUser.getLoginEmpCampusList()}"
								th:value="${(campus!=null)?campus.id:''}"
							th:selected="${ticketUpdateId!=null &&  ticketUpdateId.campus!=null && campus.id==ticketUpdateId.campus.id}"
							th:text="${campus.campusName}"></option>
					</select>
				</div>
			</div>
			<div class="col-md-6 col-xs-6">
				<div class="form-group ">
					<select  name="category" id="categoryId" class="form-control " disabled="disabled"	>
						<option th:value="0" th:text="${'Select Category'}"></option>
						<th:block th:each="category:${categoryList}">
							<option
								th:value="${(ticketUpdateId!=null && ticketUpdateId.category!=null)?ticketUpdateId.category.id:''}"
								th:selected="${ticketUpdateId!=null &&  ticketUpdateId.category!=null && category.id==ticketUpdateId.category.id}"
								th:text="${category.categoryName}"></option>
						</th:block>
					</select>
				</div>
			</div>
		</div>
		<div class="row">
			<div class="col-md-6 col-xs-6">
				<div class="form-group ">
					<select name="asset" id="asset" class="form-control"
						disabled="disabled">
						<option th:value="0" th:text="${'Select Asset'}"></option>
						<th:block th:each="asset:${asset}">
							<option
								th:value="${(ticketUpdateId!=null && ticketUpdateId.asset!=null)?ticketUpdateId.asset.id:''}"
								th:selected="${ticketUpdateId!=null &&  ticketUpdateId.asset!=null && asset.id==ticketUpdateId.asset.id}"
								th:text="${asset.assetName}"></option>
						</th:block>
					</select>
				</div>
			</div>
			<div class="col-md-6 col-xs-6">
				<div class="form-group ">
					<input type="text" class="form-control input-sm"
						placeholder="Ticket Raised By" id="ticketRaisedBy"
						th:value="${(ticketUpdateId!=null &&ticketUpdateId.createdBy!=null)?ticketUpdateId.createdBy.name:''}"
						disabled="disabled"> <input type="hidden"
						id="ticketRaisedValId"
						th:value="${(ticketUpdateId!=null &&ticketUpdateId.createdBy!=null)?ticketUpdateId.createdBy.employeeId:''}"
						name="ticketRaisedBy">
				</div>
			</div>
		</div>
		<div class="row">
			<div class="col-md-6 col-xs-6">
				<div class="form-group ">
					<select name="ticketMode" id="ticketMode" class="form-control"
						disabled="disabled">
						<option th:value="0" th:text="${'Select TicketMode'}"></option>
						<th:block th:each="ticketModeListType:${ticketModeList}">
							<option th:text="${ticketModeListType}"
								th:selected="${ticketUpdateId!=null &&  ticketUpdateId.campus!=null && ticketModeListType==ticketUpdateId.priority}"></option>
						</th:block>
					</select>
				</div>
			</div>
			<div class="col-md-6 col-xs-6">
				<div class="form-group ">
					<input type="text" id="email" name="email" placeholder="Email"
						class="form-control"
						th:value="${(ticketUpdateId!=null )?ticketUpdateId.issueEmpEmail:''}"
						disabled="disabled">
				</div>
			</div>
		</div>
		<div class="row">
			<div class="col-md-6 col-xs-6">
				<div class="form-group">
					<input type="text" id="phoneNo" placeholder="PhoneNumber"
						name="phoneNo" class="form-control"
						th:value="${(ticketUpdateId!=null )?ticketUpdateId.issueEmpNo:''}"
						disabled="disabled">
				</div>
			</div>
			<div class="col-md-6 col-xs-6">
				<div class="form-group ">
					<input type="text" class="form-control input-sm"
						placeholder="Ticket Raised By" id="ticketRaisedBy"
						th:value="${(ticketUpdateId!=null &&ticketUpdateId.createdBy!=null)?ticketUpdateId.createdBy.name:''}"
						disabled="disabled"> <input type="hidden"
						id="ticketRaisedValId"
						th:value="${(ticketUpdateId!=null &&ticketUpdateId.createdBy!=null)?ticketUpdateId.createdBy.employeeId:''}"
						name="ticketRaisedBy" disabled="disabled">
				</div>
			</div>
		</div>
		<div class="row">
			<div class="col-md-6 col-xs-6">
				<div class="form-group ">
					<input type="text" id="remarks" name="remarks" class="form-control"
						placeholder="Remarks"
						th:value="${(ticketUpdateId!=null)?ticketUpdateId.summary:''}"
						disabled="disabled">
				</div>
			</div>
			<div class="col-md-6 col-xs-6">
				<div class="form-group ">
					<select name="priority" id="priority" class="form-control"
						disabled="disabled">
						<option th:value="0" th:text="${'Select Priority'}"></option>
						<th:block th:each="priorityListType:${priorityList}">
							<option th:text="${priorityListType}"
								th:selected="${ticketUpdateId!=null &&  ticketUpdateId.campus!=null && priorityListType==ticketUpdateId.priority}"></option>
						</th:block>
					</select>
				</div>
			</div>
		</div>
		<div class="row">
			<div class="col-md-6 col-xs-6">
				<div class="form-group ">
					<input type="text" id="attachment" name="attachment"
						class="form-control"
						th:value="${(ticketUpdateId!=null)?ticketUpdateId.ticketImagePath:''}"
						disabled="disabled">
				</div>
			</div>
			<div class="col-md-6 col-xs-6">
				<div class="form-group ">
					<select name=status id="status" class="form-control">
						<option th:value="0" th:text="${'Select statusList'}"></option>
						<th:block th:each="statusListType:${statusList}">
							<option th:text="${statusListType}"
								th:selected="${ticketUpdateId!=null && statusListType==ticketUpdateId.status}"></option>
						</th:block>
					</select>
				</div>
			</div>
		</div>
		<div class="row">
			<div class="col-md-6 col-xs-6">
				<div class="row">
					<div class="col-md-12">
						<div class="form-group ">
							<input type="text" id="solution" name="solution"
								class="form-control" placeholder="Solution"
								onblur="solutionTextCounter(this,this.form.counter,500);"
								onkeyup="solutionTextCounter(this,this.form.counter,500);"
								maxlength="500">
						</div>
					</div>
				</div>
				<div class="row">
					<div class="col-md-12 col-xs-6">
						<div class="form-group ">
							<input
								onblur="solutionTextCounter(this.form.recipients,this,500);"
								disabled onfocus="this.blur();" maxlength="3" size="3"
								value="500" class="counter" name="counter"><span>Characters
								Remaining. </span>
						</div>
					</div>
				</div>
			</div>
			<div class="col-md-6 col-xs-6">
				<div class="row">
					<div class="col-md-12">
						<div class="form-group ">
							<input type="text" id="assignReason" name="assignReason"
								class="form-control" placeholder="AssignReason"
								onblur="remarksTextCounter(this,this.form.counters,500);"
								onkeyup="remarksTextCounter(this,this.form.counters,500);"
								maxlength="500">
						</div>
					</div>
				</div>
				<div class="row">
					<div class="col-md-12 col-xs-6">
						<div class="form-group ">
							<input
								onblur="remarksTextCounter(this.form.recipients,this,500);"
								disabled onfocus="this.blur();" maxlength="3" size="3"
								value="500" class="counter" name="counters"><span>Characters
								Remaining. </span>
						</div>
					</div>
				</div>
			</div>
		</div>
		<div class="row">
			<div class="col-md-6 col-xs-6">
				<div class="form-group">
					<input type="text" id="ticketAssignedTo" class="form-control"
						placeholder="TicketAssignedTo"
						th:value="${(ticketUpdateId!=null &&ticketUpdateId.assignedEmp!=null)?ticketUpdateId.assignedEmp.name:''}">
					<input type="hidden" id="ticketAssignedValId" AutoComplete="off"
						th:value="${(ticketUpdateId!=null &&ticketUpdateId.assignedEmp!=null)?ticketUpdateId.assignedEmp.employeeId:''}"
						name="ticketAssignedTo">
				</div>
			</div>
		</div>
	</form>
</body>
<th:block layout:fragment="scripts">
	<script
		src="../assets/global/plugins/bootstrap-datetimepicker/js/bootstrap-datetimepicker.min.js"
		type="text/javascript"></script>
	<script
		src="../assets/pages/scripts/components-date-time-pickers.min.js"
		type="text/javascript"></script>

	<script type="text/javascript">
		$("#fixedStartDateId").datetimepicker({
			format : 'dd-mm-yyyy hh:ii'
		});
	
		$(document).ready(function () {
		    $("#ticketAssignedTo").autocomplete({
		        source: function(request, response) {
		            $.ajax({
		                url: "/scaits/getAutoAssignedEmp",
		                dataType: "json",
		                data: {
		                    term: request.term,
		                    category: document.getElementById('categoryId').value
		                },
		                success: function(data) {
		                	 response(data);
		                }
		            });
		        },
		        focus : function(event, ui) {
				$("#ticketAssignedTo").val(
						ui.item.value);
				return false;
			},
			select : function(event, ui) {
				$("#ticketAssignedTo").val(
						ui.item.value);
				$("#ticketAssignedValId").val(
						ui.item.key);
				
				return false;
			}
		}).data("ui-autocomplete")._renderItem = function(
		ul, item) {
	return $("<li>").append(
			"<a>" + item.value+ "</a>")
			.appendTo(ul);
	}; 
		    });
		
		function solutionTextCounter(field, countfield, maxlimit) {
			if (field.value.length > maxlimit) {
				field.value = field.value.substring(0, maxlimit);
				field.blur();
				field.focus();
				return false;
			} else {
				countfield.value = maxlimit - field.value.length;
			}
		}
		function remarksTextCounter(field, countfields, maxlimit) {
			if (field.value.length > maxlimit) {
				field.value = field.value.substring(0, maxlimit);
				field.blur();
				field.focus();
				return false;
			} else {
				countfields.value = maxlimit - field.value.length;
			}
		}
	</script>
</th:block>
</html>
